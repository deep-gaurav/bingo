fragment playerFields on Player {
  id
  name
}
fragment roomFields on Room {
  id
  players {
    isConnected
    __typename
    ... on GamePlayer {
      board {
        numbers
        score(roomId: $roomId)
      }
      player {
        ...playerFields
      }
    }
    ... on LobbyPlayer {
      player {
        ...playerFields
      }
    }
  }
  state {
    __typename
    ... on LobbyData {
      players {
        player {
          ...playerFields
        }
      }
      lastGame {
        lastGame {
          leaderboard {
            rank
            player {
              ...playerFields
            }
          }
        }
      }
    }
    ... on GameData {
      leaderboard {
        rank
        player {
          ...playerFields
        }
      }
      players {
        player {
          ...playerFields
        }
        board {
          numbers
        }
      }
      boardSize
      gameState {
        __typename
        ... on BoardCreation {
          ready
        }
        ... on GameRunning {
          turn
          selectedNumbers {
            selectedBy
            cellValue
          }
        }
      }
    }
  }
}

subscription gameMessages($roomId: String, $playerId: String) {
  serverMessages(roomId: $roomId, playerId: $playerId) {
    __typename
    ... on PlayerJoined {
      player {
        ...playerFields
      }
      room {
        ...roomFields
      }
    }
    ... on PlayerConnected {
      player {
        ...playerFields
      }
      room {
        ...roomFields
      }
    }
    ... on PlayerLeft {
      player {
        ...playerFields
      }
      room {
        ...roomFields
      }
    }
    ... on PlayerRemoved {
      player {
        ...playerFields
      }
      room {
        ...roomFields
      }
    }
    ... on GameMessage {
      room {
        ...roomFields
      }
      event {
        __typename
        ... on GameStarted {
          gameState {
            __typename
            ... on BoardCreation {
              ready
            }
            ... on GameRunning {
              turn
            }
          }
        }
        ... on RoomUpdate {
          room {
            ...roomFields
          }
        }
      }
    }
  }
}
